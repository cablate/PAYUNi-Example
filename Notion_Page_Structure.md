# 金流整合實戰包 - Notion 頁面結構規劃

## 📋 整體架構

```
主頁 (Dashboard)
├── 快速導覽卡片（四大模組）
├── 一小時快速成功清單
├── 推薦學習路徑
└── 常見問題速查

分頁 1：設計理念
├── 核心挑戰 × 4
├── 通用原則解析
└── 快速開始三步驟

分頁 2：系統架構
├── 核心元件與責任邊界
├── 三大流程詳解
│   ├── 流程一：使用者登入（含 Mermaid 圖）
│   ├── 流程二：建立訂單（含 Mermaid 圖）
│   └── 流程三：支付確認（含 Mermaid 圖）
├── 自我檢核清單（可打勾）
└── 設計啟示與下一步

分頁 3：安全機制
├── 五層防禦深度解析
│   ├── Helmet（HTTP 防線）
│   ├── CORS（跨域控制）
│   ├── CSRF（防止偽造）
│   ├── Session（狀態保護）
│   └── AES-256-GCM（加密）
├── 常見錯誤與最佳實踐
└── 檢查清單

分頁 4：動手實踐
├── 學習進度表（可打勾）
├── 任務 1：新增/修改商品
├── 任務 2：調整 CSS 與風格
├── 任務 3：修改文案
├── 任務 4（進階）：擴充商品屬性
└── 一小時成功驗證
```

---

## 🎯 主頁 (Dashboard) 詳細設計

### 📍 版面佈局

**第一區塊：歡迎語 + 課程定位**
```
┌─────────────────────────────────────────┐
│  金流整合實戰包                          │
│  一套完整的支付系統 × 學習教材           │
│  不只是代碼，更是能力              │
└─────────────────────────────────────────┘
```

**第二區塊：四大導覽卡片（使用 Notion Database 或 Synced Block）**
```
┌────────────────┬────────────────┬────────────────┬────────────────┐
│   設計理念      │   系統架構      │   安全機制      │   動手實踐      │
│                │                │                │                │
│  🎯 為什麼      │  🏗️ 怎麼運作    │  🔒 怎麼保護    │  🛠️ 怎麼改造    │
│  這樣設計       │  4 個核心元件  │  5 層防線       │  4 個實作任務   │
│                │  3 個流程圖    │                │  1 小時成功     │
│  點擊進入 →    │  點擊進入 →    │  點擊進入 →    │  點擊進入 →    │
└────────────────┴────────────────┴────────────────┴────────────────┘
```

**第三區塊：一小時快速成功清單**
```
┌─────────────────────────────────────────┐
│  ⏱️ 一小時快速成功路線圖                 │
│                                          │
│  ✅ 0-15 分鐘：體驗現況                  │
│     - npm start 啟動伺服器               │
│     - Google 登入測試                    │
│                                          │
│  ✅ 15-30 分鐘：完成第一筆訂單           │
│     - 新增測試商品                       │
│     - 跳轉 Payuni 支付                   │
│                                          │
│  ✅ 30-45 分鐘：驗證資料流               │
│     - 觸發測試付款                       │
│     - 確認 Google Sheet 寫入              │
│                                          │
│  ✅ 45-60 分鐘：套用第一個客製化         │
│     - 改個色 / 改個文案 / 新增欄位       │
│     - 提交到 Git                         │
└─────────────────────────────────────────┘
```

**第四區塊：推薦學習路徑（可折疊的 Toggle）**
```
🎓 根據您的角色選擇

▶ 我是完全新手（0-2 小時）
  ✓ 先讀：設計理念（為什麼）
  ✓ 再讀：系統架構（怎麼做）
  ✓ 動手：新增商品 + 改色

▶ 我懂程式，想快速上手（1-2 小時）
  ✓ 掃一眼：系統架構流程圖
  ✓ 重點看：安全機制五層防線
  ✓ 動手：擴充商品屬性（進階）

▶ 我準備上線了（2-3 小時）
  ✓ 必讀：設計理念 + 安全機制
  ✓ 逐項檢查：04_DEPLOYMENT.md（內部參考）
  ✓ 驗證：上線前檢查清單

▶ 我有特定疑問
  ✓ 搜尋本頁面（Cmd+F 或 Ctrl+F）
  ✓ 查看「常見問題速查」
```

**第五區塊：快速索引表**
```
| 我想要... | 應該看... | 預期耗時 |
|-----------|----------|--------|
| 理解系統為什麼這樣設計 | 設計理念 | 10 分 |
| 了解每個模組的作用 | 系統架構 | 15 分 |
| 學習安全防護機制 | 安全機制 | 20 分 |
| 修改商品或配色 | 動手實踐 | 30 分 |
| 部署到線上環境 | 內部文件 04_DEPLOYMENT.md | 60 分 |
| 遇到問題排查 | 內部文件 07_TROUBLESHOOTING.md | 依情況 |
```

---

## 📄 分頁 1：設計理念 (00_DESIGN_PHILOSOPHY)

### 版面結構

**頁面開場**
```
設計理念：為什麼這樣做

這份文件，想跟你聊聊「為什麼」。

[完整段落]
```

**主要內容：四大挑戰 + 通用原則**

用 **Notion Toggle Block** 摺疊每個挑戰：

```
▶ 挑戰 1：我怎麼確保顧客的資料安全？
  [展開時顯示：
   - 背景敘述
   - 問題清單
   - 解決原則
   - 應用案例
   - 對應表格]

▶ 挑戰 2：系統怎樣設計才不會變成一團亂？
▶ 挑戰 3：支付成功了，我怎麼才能確定？
▶ 挑戰 4：我怎麼知道系統哪裡出問題了？
```

**通用設計原則小結**
- 完整表格（4 行 3 欄）：挑戰來源 | 設計原則 | 可應用場景

**課程實踐方式**
```
🔍 本課程如何實踐這些原則

文字說明 × 3 項
```

**快速開始三步驟**
```
⚡ 快速開始：把理念化成行動

✓ Step 1：定位你的學習目標（5 分鐘）
✓ Step 2：親眼看看系統架構（5 分鐘）
✓ Step 3：帶著問題進入下一章（5 分鐘）
```

**頁面結尾：下一步**
```
📌 重要提醒：[段落]

👉 下一步：前往「系統架構」
```

---

## 📄 分頁 2：系統架構 (01_SYSTEM_ARCHITECTURE)

### 版面結構

**快速導航**
```
📚 閱讀順序建議
- ✓ 已讀 00_DESIGN_PHILOSOPHY.md（了解「為什麼」）
- ⏳ 正在讀本文（了解「怎麼做」）
- 🔜 接下來看：安全機制 / 客製化 / 部署
```

**核心元件與責任邊界**
```
表格 1：核心元件拆解
- 6 行表格（元件 | 技術 | 角色）

表格 2：元件責任與信任邊界
- 表格（元件 | 負責什麼 | 不負責什麼 | 為什麼）
```

**三大流程詳解（核心內容，使用 Toggle 分區）**

```
▶ 流程一：使用者登入 (Google OAuth 2.0)
  │
  ├─ 情境提要（開場故事）
  ├─ Mermaid 流程圖（完整嵌入或截圖）
  ├─ 7 個步驟說明（編號列表）
  ├─ 自我檢核 3 題
  │  ├─ 🔰 基礎理解（看懂流程）
  │  ├─ 🌟 進階思考（理解原理）
  │  └─ 🌟🌟 應用能力（遷移場景）
  └─ 核心概念總結

▶ 流程二：建立訂單與前往支付
  ├─ 情境提要
  ├─ Mermaid 流程圖
  ├─ 4 個階段說明
  ├─ 自我檢核 3 題
  └─ 核心概念總結

▶ 流程三：支付確認與訂單紀錄 (Webhook)
  [同上結構]
```

**難度升級提示（警告框）**
```
🚀 難度升級提示

讀到這裡，你已經理解了「使用者登入」和「建立訂單」...
[完整段落]
```

**結論：為什麼每一道防線都重要**
```
[段落] + 4 點要點
```

**設計啟示：可轉移技能**
```
▶ 1. 多層驗證的思維
  ├─ 金流案例的體現
  ├─ 可應用的場景
  └─ 核心啟示

▶ 2. 關注點分離的架構
▶ 3. 非同步通訊的處理
▶ 4. 安全優先的設計原則
```

**檔案結構樹（程式碼塊）**
```javascript
.
├── docs/
├── @gas/
├── @n8n/
├── data/
│   └── products.js
├── logs/
├── public/
│   ├── app.js
│   ├── result.js
│   └── style.css
├── utils/
│   ├── crypto.js
│   └── logger.js
├── .env.example
├── index.js
├── index.html
├── result.html
└── package.json
```

**下一步導覽表**
```
| 如果你想... | 推薦閱讀 |
|-----------|--------|
| 深入了解安全防護機制 | 安全機制 |
| 自己客製化這套方案 | 動手實踐 |
| 部署到線上環境 | 內部文件 04_DEPLOYMENT.md |
| 遇到問題找答案 | 內部文件 07_TROUBLESHOOTING.md |
```

**本章學到的能力（打勾清單）**
```
☐ 系統拆解：能畫出「前端→後端→第三方→資料庫」的資料流
☐ 信任邊界判斷：能說清楚「為什麼前端不能信」
☐ 非同步設計思維：理解「Return URL vs Webhook」的差異
☐ 防線設計：能指出每個流程中「驗證、加密、防偽造」在哪裡
```

---

## 📄 分頁 3：安全機制 (02_SECURITY_DEEP_DIVE)

### 版面結構

**開場與定位**
```
安全性深度解析

歡迎來到「金流整合實戰包」的安全性核心...
[完整段落]
```

**五層防護（核心結構，使用 Tab 或 Toggle）**

選項 A - 使用 Toggle（推薦，因為每層內容多）：
```
▶ 第 1 層：Helmet - 您的第一道 HTTP 防線
  ├─ 是什麼？
  ├─ 為什麼重要？
  ├─ 具體做了什麼？（列表）
  ├─ 簡單來說...（比喻）
  ├─ 在金流實戰包中的實例
  ├─ 延伸思考：這個機制可以用在哪裡？
  │  ├─ 適用場景（列表）
  │  └─ 關鍵啟示（粗體）
  └─ ⚠️ 常見錯誤 / 誤解（3 項）

▶ 第 2 層：CORS - 精準控制 API 存取
  [同上結構]

▶ 第 3 層：CSRF - 保護使用者操作的真實性
  [同上結構]

▶ 第 4 層：Session - 保護使用者的登入狀態
  [同上結構]

▶ 第 5 層：AES-256-GCM - 保護您的敏感資料
  [同上結構]
```

**重點回顧**
```
讀完本文後，您應該理解了：

✓ Helmet 為什麼能透過 HTTP 標頭防止...
✓ CORS 為什麼只允許...
✓ CSRF Token 為什麼能防止...
✓ Session 安全設定中每一項參數的具體用途
✓ 什麼時候應該用 AES-256-GCM 加密
```

**下一步導覽表**
```
| 如果你想... | 推薦閱讀 |
|-----------|--------|
| 客製化這套方案 | 動手實踐 |
| 部署到線上環境 | 內部文件 04_DEPLOYMENT.md |
| 複習系統流程 | 回到系統架構 |
| 還有其他疑問 | 回到設計理念了解整體 |
```

**最後提醒**
```
安全不是一次性的工作，而是持續的責任。當您客製化或擴充功能時，請務必：

1. 不要移除或禁用任何現有的安全機制
2. 為新增功能套用相同的防護原則
3. 定期檢查 `.env` 文件

您的使用者信任您；請用這些工具好好保護他們。
```

---

## 📄 分頁 4：動手實踐 (03_CUSTOMIZATION_GUIDE)

### 版面結構

**開場與重要提醒**
```
動手實踐指南

恭喜您已經理解了系統的設計邏輯！這一章的必要性在於，
把「理解」轉化為「功能開發能力」...

💡 重要提醒
這不只是在「改工具」，更是在「驗證你是否真正理解了架構」。
```

**學習進度表（打勾清單）**
```
┌─────────────────────────────────────────┐
│  你的學習進度                            │
│                                          │
│  ☐ 任務 1：新增/修改商品（15 分）       │
│  ☐ 任務 2：調整 CSS 與風格（15 分）     │
│  ☐ 任務 3：修改文案（10 分）            │
│  ☐ 任務 4：擴充商品屬性（20 分）        │
│                                          │
│  ✨ 全部完成 = 一小時成功！              │
└─────────────────────────────────────────┘
```

**學習地圖表**
```
| 建議順序 | 任務 | 主要概念 | 相關檔案 |
|--------|------|--------|--------|
| ① | 新增/修改商品 | 靜態資料、伺服器啟動流程 | data/products.js, index.js |
| ② | 調整 CSS/字體 | 靜態資源、快取、品牌一致性 | public/style.css, public/result.style.css |
| ③ | 修改文案 | 內容管理、部署與快取刷新 | index.html, result.html |
| ④ | 擴充商品屬性 | 端到端資料流、API 與自動化 | data/products.js, public/app.js, index.js, @gas/code.gs |
```

**任務區塊（使用 Toggle 分組）**

```
▶ 任務 1：新增、修改或刪除商品（⏱️ 15 分）
  │
  ├─ 目標檔案：data/products.js
  ├─ 檔案結構範例（程式碼塊）
  ├─ 操作步驟（編號列表）
  ├─ 🔄 反思提問 × 3（可折疊）
  │  ├─ 為什麼新增商品需要重啟伺服器？
  │  ├─ 如果這個系統要擴展到 1000 個商品...
  │  └─ 如果你想讓商品資料「即時更新」...
  └─ 📌 核心概念：靜態資料 vs 動態資料、伺服器啟動時的初始化

▶ 任務 2：調整網站外觀與風格 (CSS)（⏱️ 15 分）
  ├─ 目標檔案：public/style.css, public/result.style.css
  ├─ 範例 1：更換網站主色系（步驟 + 程式碼）
  ├─ 範例 2：更換全站字體（步驟 + 程式碼）
  ├─ 🔄 反思提問 × 3（可折疊）
  └─ 📌 核心概念

▶ 任務 3：修改網頁文案（⏱️ 10 分）
  ├─ 目標檔案：index.html, result.html
  ├─ 操作步驟
  ├─ 🔄 反思提問 × 3
  └─ 📌 核心概念

▶ 任務 4 (進階)：擴充商品屬性（⏱️ 20 分）
  ├─ 目標：新增 description 欄位
  ├─ Step 1：修改資料 (data/products.js)
  ├─ Step 2：修改前端 (index.html & public/app.js)
  ├─ Step 3：修改後端 (index.js)
  ├─ Step 4：修改資料庫 (@gas/code.gs & Google Sheet)
  ├─ 各步驟的程式碼範例（可折疊的程式碼塊）
  ├─ 🔄 反思提問 × 3
  └─ 📌 核心概念：端到端的資料流設計
```

**重要提醒表**
```
| 修改檔案類型 | 需要做什麼 |
|-----------|---------|
| data/products.js | 重啟後端伺服器 (npm start) |
| index.js (後端邏輯) | 重啟後端伺服器 (npm start) |
| CSS / JavaScript | 刷新瀏覽器 (Ctrl+Shift+R) |
| HTML | 刷新瀏覽器 (Ctrl+Shift+R) |
| @gas/code.gs | 在 Google Apps Script 編輯器中重新部署 |
```

**一小時成功驗證清單**
```
✅ 檢查清單：你完成了嗎？

第 15 分鐘檢查點：
☐ npm start 成功啟動
☐ Google 登入正常
☐ Turnstile 驗證正常

第 30 分鐘檢查點：
☐ 新商品已出現在首頁
☐ 能建立訂單
☐ 成功跳轉至 Payuni

第 45 分鐘檢查點：
☐ 測試付款已完成
☐ Google Sheet 有新訂單紀錄
☐ 日誌或 GAS log 顯示 Webhook 執行

第 60 分鐘檢查點：
☐ 完成至少一個客製化（改色、改文案、新增欄位）
☐ 修改已提交到 Git
☐ 能清楚解釋「下一步想做的擴充」

🎉 如果全部打勾，恭喜！你已掌握核心能力！
```

**下一步導覽**
```
| 如果你想... | 推薦閱讀 |
|-----------|--------|
| 部署到線上環境 | 內部文件 04_DEPLOYMENT.md |
| 複習安全考量 | 回到安全機制 |
| 了解系統整體 | 回到系統架構 |
| 遇到問題 | 內部文件 07_TROUBLESHOOTING.md |
```

---

## 🔗 Notion 頁面的技術細節

### 推薦的 Notion 功能應用

| 功能 | 用途 | 應用位置 |
|-----|------|--------|
| **Toggle Block** | 摺疊/展開內容，節省版面 | 四大挑戰、五層防護、四個任務 |
| **Database** | 建立導覽卡片 | 主頁的四大模組卡片 |
| **Table of Contents** | 自動生成目錄 | 每個分頁的開頭 |
| **Callout** | 提示框、重要提醒 | 💡 提醒、🚀 難度升級、⚠️ 常見錯誤 |
| **Synced Block** | 同步內容 | 如果多個地方引用同一內容 |
| **Checkbox** | 打勾清單 | 自我檢核、進度表、一小時驗證 |
| **Code Block** | 程式碼顯示 | 所有程式碼片段 |
| **Image / Embed** | 圖片嵌入 | Mermaid 流程圖（截圖或嵌入連結） |
| **Quote** | 引言 | 情境提要、關鍵啟示 |
| **Divider** | 分隔線 | 區分不同段落 |

### 色彩與視覺層級建議

```
標題色系：
- H1（分頁名稱）：藍色 + 大號
- H2（主要區塊）：深藍色
- H3（子區塊）：淺藍色

強調：
- 核心概念：粗體 + 圖標（📌）
- 常見錯誤：紅色 Callout
- 提示：黃色 Callout
- 成功點：綠色 Callout

圖標運用：
- 🎯 目標
- 📚 學習
- 🔒 安全
- 🛠️ 工具
- ⚡ 快速
- ✅ 完成
- ❌ 常見錯誤
- 💡 提示
- 🚀 進階
- 🔍 深入
```

---

## 📊 內容容量評估

```
主頁：            ~2000 字 + 4 張卡片 + 3 個表格
設計理念分頁：     ~4000 字 + 2 個表格 + 1 個清單
系統架構分頁：     ~8000 字 + 3 個 Mermaid 圖 + 6 個表格 + 12 個自我檢核題
安全機制分頁：     ~6000 字 + 5 個系統段落 + 2 個表格
動手實踐分頁：     ~5000 字 + 20 個程式碼塊 + 4 個表格 + 12 個反思提問

總計：約 25,000 字 + 50+ 個表格/清單 + 3 個流程圖 + 20+ 個程式碼塊
```

---

## 🚀 建置順序建議

**第一階段（Day 1）：**
1. 建立主頁框架 + 四大卡片
2. 搬移設計理念分頁（最簡單）
3. 測試 Toggle 和表格顯示

**第二階段（Day 2）：**
1. 搬移系統架構分頁（最複雜，含 Mermaid）
2. 嵌入或截圖三個流程圖
3. 驗證所有連結和導覽

**第三階段（Day 2-3）：**
1. 搬移安全機制分頁
2. 搬移動手實踐分頁
3. 測試所有程式碼塊和反思提問

**第四階段（Day 3）：**
1. 整體檢查和優化
2. 測試導覽流程
3. 檢查快取和載入速度

---

## ✅ 驗收清單

完成後應該檢查：

- [ ] 四個分頁都能順利開啟
- [ ] 所有 Toggle 都能正常摺疊/展開
- [ ] 表格格式正確，沒有文字溢出
- [ ] 程式碼塊高亮顯示正確
- [ ] 所有連結都能正常跳轉
- [ ] Mermaid 圖表正確顯示（或截圖清晰）
- [ ] 打勾清單能正常操作
- [ ] 主頁的四張卡片連結到正確分頁
- [ ] 每個分頁都有「下一步」導覽
- [ ] 沒有孤立的內容或斷裂的連結
- [ ] 在 Notion 手機版本上也能正常顯示
- [ ] 頁面載入時間合理（< 3 秒）
