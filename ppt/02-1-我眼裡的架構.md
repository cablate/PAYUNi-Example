# 🎙️ Chapter 2-1: 我眼裡的架構 (The Architect's Mental Model) - WIIFM

**(開場：建立連結與心態建設)**

Hello 大家好。

這一個小節，我不想直接開程式碼編輯器，也不想直接講 PPT。我想把節奏放慢一點，跟大家分享一下我的「大腦」在這個階段都在運作些什麼。

這章節對於正在學習 Vibe Coding 的同學來說，我覺得會非常非常受用。雖然，等一下我要講的內容，可能會讓你感受到一點點壓力，但我相信你會有感覺的。因為我知道，你腦中的那個 Idea，絕對不只是想做一個小工具、或者一個單機版的小網頁而已。

你想處理更複雜的邏輯、更安全的應用，甚至你想把它變成一個可以運營的生意。
**這也是為什麼你需要在這裡停下來聽我說。因為如果你跳過這一步，直接去複製貼上程式碼，未來你花在「修 Bug」和「重寫架構」的時間，絕對會是你現在聽這幾分鐘的十倍以上。**
如果你有把它做大、做穩的野心，那接下來這幾分鐘的分享，就是我過去踩過無數個坑之後，幫大家省下時間與學費的心法。

---

**(Step 1: 可行性驗證 - 避免承諾跳票)**

首先，當一個想法突然出現在腦袋時——比如說：「我想做一個 AI 自動發文機器人」——我第一件事絕對不是去想 UI 長怎樣，也不是去想 LOGO 要用什麼顏色。

我會先冷靜下來問自己一句話：「這在技術上，是可能的嗎？」

這中間，不管你是要去問 AI、去查官方文件，還是要去諮詢專家，總之你必須在動手之前，先找到證據。只要你有辦法驗證這個想法是可行的，那這條路才值得走下去。這就是你的產品核心。如果不先驗證它，那後面做再多漂亮的介面、接再厲害的金流，都是沒有用的，因為核心根本跑不動。

所以第一步，我會非常務實。假設我要做自動發文工具，那它的核心是什麼？是「發文」。沒錯吧？
所以我勢必要先驗證：我要發的那個社群平台，有沒有提供 API 讓我用程式發文？
如果沒有 API 呢？我能不能寫一個自動化腳本來模擬人類的點擊操作？
總之不論用什麼方法，我必須確認這條路是通的。驗證可行，我們才往下走。

**這一步雖然聽起來很基本，但它能保護你的名聲。試想一下，如果你已經跟老闆或客戶拍胸脯說「這功能沒問題」，結果開發到一半才發現平台根本不開放 API，那種尷尬的場面，我不希望發生在你們身上。**

---

**(Step 2: 商業模式與資料結構 - 治癒「資料庫焦慮」)**

驗證結束後，確認技術可行了。接下來我們就要來思考：我有要提供服務嗎？我有要把它變成一個產品嗎？

這一點非常關鍵。因為「有沒有提供服務」，就會牽扯到「我有沒有會員系統？」、「我有沒有權限控管的機制？」。
緊接著，我們要怎麼提供服務？這就是商業模式的問題了。
你是要讓用戶「一次性買斷」？還是要讓他們「每個月訂閱」？還是你是賣「現貨商品」？

很多初學者覺得這只是行銷的問題，錯了，**這完全會影響你的程式結構與資料庫設計**。

我們試想一下：
*   如果是**買斷制**：我可能只需要在資料庫紀錄「誰」、「付過錢了沒」，就結束了。
*   如果是**月訂閱**：事情就變複雜了。我就要記錄「訂閱週期」、「下一次扣款日」、「現在的訂閱狀態是活躍還是過期」。
*   如果是**賣實體商品**：那你連地址、物流狀態都要納入考量。

試想一下，假設你沒有在這個時候——也就是還沒寫 Code 之前——就先想到這一步。等你一切功能都搞定，個人使用上沒問題，這時你才想說：「欸，好像可以拿來賣」。
這時候會發生什麼事情？
沒錯，災難發生了。你會發現你的資料結構完全不對，為了加進去這些商業邏輯，你需要把地基挖開，為了安全性或穩定性去大幅調整架構。那個痛苦指數是非常高的。

**我知道大家最怕的就是「不知道資料庫欄位怎麼開」，怕開錯了以後很難改。只要你在這一步想清楚了商業模式，你的資料庫焦慮自然就會消失，因為答案都已經在你的商業邏輯裡了。**

---

**(Step 3: 身分證明 - 保護你的錢包與信任)**

倘若我們決定要販售服務，接著我們要思考的是：如何販售？要怎麼收錢？
對吧，這就是我們這堂課「從金流串接到架構」的一個重點嘛——金流串接。

這邊我也要順便跟大家建立一個非常重要的觀念。
當你以後看到任何教學、任何文件寫著「串接某某服務」——例如串接金流、串接 AI、串接地圖服務——你腦袋裡絕對要立刻飄出一個詞，叫做 **"API Key"**。

雖然你在文件上看到的名稱不一定叫 API Key，可能是 Secret、可能是 Token，但概念都是一樣的。
這東西就是你去使用那些服務的「身分證明」。誰擁有它，誰就能以你的身分去使用那些服務、去花你的錢、去操作你的後台。這也是我們常常在網路上看到什麼「Key 洩漏」、「被盜刷」事件的主角。

所以，它非常重要，我們要死命地保護好它。

但是呢，這裡有個技術限制：**前端（你的瀏覽器、網頁）是完全沒辦法保護它的。**
任何寫在前端程式碼裡的東西，對於有心人士來說，都絕對可以被挖出來。我沒騙你，這只是麻煩不麻煩而已，但在資安的世界裡，前端就是透明的。

所以，這決定了我們的架構：我們需要將 Key 的運作放在**後端（伺服器端）**。
我們必須把 Key 藏在伺服器裡，然後讓前端透過我們自己的後端 API，去間接使用這個 Key。

這種資訊安全的環節，是架構思考裡很重要的一環啊。你如果沒想到這段，你產品上線絕對是會出事的。
**你能想像如果因為你的疏忽，導致客戶的信用卡被盜刷，或是你綁定的信用卡收到幾十萬的帳單嗎？這不是危言聳聽，這是為了保護你的錢包，也保護使用者對你的信任。學會這一招，你就比 80% 只會寫前端的人更值得信賴。**

---

**(Step 4: 金流選型 - 展現「顧問級」的決策力)**

所以此時此刻，我們已經想好金流的場景（後端）放在哪裡，那接下來就是要怎麼實作金流串接了。

金流串接，通常有兩條路可以選。我們要思考的是：**怎麼樣才能最小化我們的負擔與風險？**

1.  **幕後交易 (API)**：使用者在你的網站輸入卡號，你的伺服器把卡號送去金流商。這種方式通常需要通過 **PCI-DSS** 的資安驗證。而且因為信用卡號「路過」或「暫存」在你的伺服器，那個資安責任是非常巨大的。那你就要評估，這樣的風險跟維護成本，你能 Handle 嗎？至少對於剛起步的產品或個人開發者來說，我是不想 Handle 啦。
2.  **付款頁 (Hosted Page)**：使用者點擊按鈕，跳轉到金流商（如 Stripe、綠界、統一）的頁面上輸入卡號。

當我們把第一種刪去之後，就剩下「付款頁」的方式。
這時候我們就要評估：付款頁真的安全嗎？這時候我們就要去挖文件、看它怎麼運作。當我們評估它安全，而且能把資安責任轉嫁給金流商之後，我們就決定使用它。詳細的實作後續章節會說，這邊我們先確定「選型」。

**學會做這個選擇很重要。未來如果有客戶問你：「為什麼不讓我在網站直接刷卡？」你可以很專業地告訴他關於 PCI-DSS 和資安風險的成本。這就是專業顧問與普通工程師的差別，你的價值就體現在這些決策裡。**

---

**(Step 5: 訂單同步 - 打造「不掉單」的穩固系統)**

好了，我們目前為止，解決了商業模式下的考量、支付環節的選型、也知道要保護 API Key 了。接下來，我們就該考慮支付的「後續」了。

我們要先有一個認知：**支付平台是支付平台，你的網站是你的網站。**
任何一次交易，都是發生在支付平台那邊，而不是我們的平台。理解嗎？

所以我們最重要的資料是什麼？是**「訂單狀態」**。
用戶付完錢了，這個狀態要怎麼在「支付平台」與「我們的平台」之間進行同步？你想得到嗎？

可能有同學會說：「那我寫個程式，每隔 5 分鐘去查詢一次訂單回來就好（Polling）。」
聽起來是個不錯的選擇，邏輯也通。
但身為架構師，只要你腦中想到任何這種「定期去爬一次」的邏輯當下，你都要先反問自己：「那有沒有 **Webhook** 可以用？」

Webhook 簡單來說，就是一個**「讓對方主動通知你」**的管道，而不是你一直去問他「好了沒？好了沒？」。
只要金流服務有提供 Webhook（絕大多數都有），那我們就應該優先使用它。這才是最即時、最節省資源的作法。

**這對你來說有什麼好處？這意味著你的用戶付完錢的當下，幾乎零秒差就能拿到服務，不會發生「我付錢了但系統沒反應」的客訴。一個穩定的系統，才能讓你晚上睡得著覺。**

---

**(Step 6: 資料庫選型 - 降低門檻，快速啟動)**

那我們目前為止就解決了：
1.  商業模式下的資料與架構設計
2.  如何支付、付款行為的選型
3.  訂單同步機制

那既然要有會員、又要存訂單，我們是不是就要考慮，這些東西存在哪裡？
這時候同學很機靈，馬上說：「資料庫！」

沒錯，是資料庫。但這裡我想分享一個觀點：**資料庫的選擇，可以很簡單，也可以很複雜。**
在 MVP（最小可行性產品）驗證階段，我們要追求的是速度和可視性。

你要怎麼既方便看到資料、又方便程式去讀寫呢？
大家一定要用很重型的 SQL 嗎？不一定。
**我可以用 Google Sheets 嗎？當然可以！**
**我可以用 SQLite 這種輕量級的嗎？絕對沒問題。**

我不是說 Google Sheets 可以完全取代正規的 SQL 資料庫，但在初期驗證階段，你能直接打開手機 App 就看到剛剛誰下單了、直接在試算表上手動改一下使用者的權限，這種「便利性」是非常強大的。
這些都是身為架構師，你可以考量、可以靈活運用的部分哦。不要被工具綁死了。

**這也是這門課想帶給你的：我不希望你因為覺得「資料庫好難」就放棄你的 idea。我們會教你用最熟悉的工具，一樣能做出專業的自動化流程。**

---

**(總結: The Happy Path - 你的下一步)**

所以，講了這麼多，目前為止我們腦袋裡的畫面應該會是這樣：

一個決定做訂閱制的服務。
因為要訂閱，所以需要設計訂單、會員、權限資格的資料結構。
核心功能已經驗證可行了。
會有一個後端伺服器端，用來存放 API Key。
支付選用「付款頁」支付，避開資安地雷。
資料庫部分，我們策略性地選擇「怎麼簡單就怎麼做」（例如先用 Google Sheets）。

那這個架構做出來的效果是什麼？
**一個有登入機制、可以安全下單、並且下單成功後，我可以清晰看到自己的訂單完成、並且自動獲得訂閱資格的系統。**

這就是我們所謂的 **"Happy Path"**（快樂路徑）。

當我們完全做出這樣的東西之後，行有餘力，再來考量別的部分。
這樣的 Happy Path 是必須要能夠先被驗證的。至於剩下的極端狀況，請相信絕對會有辦法處理。
但如果你連這條最核心的 Happy Path 都會出問題、安全性你無法確保、或是風險太高，那你就要回頭思考，是不是在一開始的架構思考上，有什麼關鍵點自己 Miss 掉了。

**這就是我在動手寫 Code 之前，腦袋裡會先跑過的一場演習。**
**有了這張地圖，接下來我們進入實作時，你就不會是盲目地複製程式碼，而是像一個真正的工程師一樣，知道自己在蓋什麼。**
**準備好了嗎？我們下一章見。**